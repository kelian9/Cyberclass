{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport styles from './Lesson.module.scss';\nimport LessonCard from \"../../components/ui/LessonCard/LessonCard\";\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport checkLoggedIn from '../../common/checkLoggedIn';\nimport { LessonsAPI } from '../../api/lessons';\nimport { setLessons } from '../../store/actions/lessons-actions';\nimport { RatingAPI } from '../../api/rating';\nimport { setMaterials, rateMaterialState } from '../../store/actions/materials-actions';\nvar testLessons = [{\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}, {\n  name: 'Введение',\n  description: 'Мы поделимся лучшими настройками управления, камеры и других игровых параметров'\n}];\n\nvar Lesson = function Lesson(_ref) {\n  var _store$getState$Mater;\n\n  var store = _ref.store;\n  var router = useRouter();\n  var materialState = (_store$getState$Mater = store.getState().MaterialsReducer) === null || _store$getState$Mater === void 0 ? void 0 : _store$getState$Mater.find(function (_ref2) {\n    var id = _ref2.id;\n    return id === +router.query.materialID;\n  });\n  var lessonsState = store.getState().LessonsReducer;\n\n  var _useState = useState(null),\n      selectedLesson = _useState[0],\n      _selectLesson = _useState[1];\n\n  var rateMaterial = function rateMaterial(type) {\n    checkLoggedIn() && !materialState.myLike && !materialState.myDislike ? RatingAPI.rateMaterial(+router.query.materialID, type).then(function (response) {\n      store.dispatch(rateMaterialState({\n        id: +router.query.materialID,\n        ratingType: type\n      }));\n      console.log(response);\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    }) : null;\n  };\n\n  var getLessons = function getLessons(materialID) {\n    (checkLoggedIn() ? LessonsAPI.getLessons(materialID) : LessonsAPI.getNotAuthorizeLessons(materialID)).then(function (response) {\n      store.dispatch(setLessons(response.data));\n\n      _selectLesson(response.data[0]);\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  };\n\n  var getCourse = function getCourse() {\n    (checkLoggedIn() ? LessonsAPI.getMaterials() : LessonsAPI.getNotAuthorizeMaterials()).then(function (response) {\n      store.dispatch(setMaterials(response.data));\n      getLessons(response.data[0].id);\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  };\n\n  useEffect(function () {\n    !materialState ? getCourse() : null;\n    lessonsState.length == 0 ? getLessons(+router.query.materialID) : null;\n    !selectedLesson ? _selectLesson(lessonsState[0]) : null; // window.location.replace(selectedLesson?.url + '&output=embed')\n  });\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: styles['selected-lesson']\n  }, (selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.url) ? __jsx(\"iframe\", {\n    src: selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.url,\n    allow: \"autoplay; fullscreen; encrypted-media; gyroscope; picture-in-picture\",\n    frameBorder: \"0\"\n  }) : __jsx(\"div\", {\n    className: styles['selected-lesson_preview']\n  }, __jsx(\"img\", {\n    src: selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.preview,\n    alt: \"\"\n  }), __jsx(\"img\", {\n    src: \"/static/images/play-circle.svg\",\n    alt: \"\",\n    className: styles['play-icon']\n  }), __jsx(\"span\", {\n    className: styles.duration\n  }, selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.duration, \":00\"), __jsx(\"span\", {\n    className: styles['duration-line']\n  })), __jsx(\"div\", {\n    className: styles['selected-lesson_info']\n  }, __jsx(\"div\", {\n    className: styles['heading-row']\n  }, __jsx(\"img\", {\n    src: \"/static/images/fifa20.svg\",\n    alt: \"\"\n  }), __jsx(\"a\", {\n    className: \"transparent-btn\"\n  }, \"Get access to all cources\")), __jsx(\"h1\", null, \"0\", selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.number, \": \", selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.name), __jsx(\"h2\", null, \"\\u043E\\u0442 mozz \\u0438 klenoff\"), __jsx(\"p\", {\n    className: styles.rating\n  }, \"Rate this\\xA0\\xA0\\xA0\", materialState === null || materialState === void 0 ? void 0 : materialState.likeCount, \" \", __jsx(\"img\", {\n    src: \"/static/images/like.svg\",\n    alt: \"\",\n    onClick: function onClick() {\n      return rateMaterial(0);\n    },\n    className: (materialState === null || materialState === void 0 ? void 0 : materialState.myLike) ? styles['rated'] : null\n  }), \"\\xA0\\xA0\", materialState === null || materialState === void 0 ? void 0 : materialState.dislikeCount, \" \", __jsx(\"img\", {\n    src: \"/static/images/like.svg\",\n    alt: \"\",\n    onClick: function onClick() {\n      return rateMaterial(1);\n    },\n    className: (materialState === null || materialState === void 0 ? void 0 : materialState.myDislike) ? styles['rated'] : null\n  })), __jsx(\"p\", null, selectedLesson === null || selectedLesson === void 0 ? void 0 : selectedLesson.description), __jsx(\"button\", {\n    className: \"common-btn\"\n  }, \"Open workbook\"))), __jsx(\"div\", {\n    className: \"content-container\"\n  }, __jsx(\"div\", {\n    className: styles.tab\n  }, __jsx(\"div\", {\n    className: styles.tab_btns\n  }, __jsx(\"button\", null, \"Free lessons\"), __jsx(\"button\", null, \"Buy lessons\")), __jsx(\"div\", {\n    className: styles.tab_view\n  }, lessonsState === null || lessonsState === void 0 ? void 0 : lessonsState.map(function (item, index) {\n    return __jsx(LessonCard, {\n      lesson: item,\n      selectLesson: function selectLesson(id) {\n        return _selectLesson(lessonsState.find(function (item) {\n          return item.id === id;\n        }));\n      },\n      key: index\n    });\n  })), (lessonsState === null || lessonsState === void 0 ? void 0 : lessonsState.length) > 6 ? __jsx(\"button\", {\n    className: \"common-btn\"\n  }, \"Show more\") : null)));\n};\n\nexport default Lesson;","map":null,"metadata":{},"sourceType":"module"}